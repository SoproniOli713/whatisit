/*
*	Created on : 08 14, 14, 4:12:53 PM
*   Author     : Soproni B. Oli
*   Package : Game
*   Name : What is It
*   Project : True or False
*   Email : SoproniOli713@gmail.com
*	Version : 1.0
*/
"use strict";
function timer(){this.disp_timer=null,this.timerSet=null,this.starTime=null,this.request_id=null,this.isRunning=null,this.ticktock=$(".sound-clock"),this.remap_display=!1}function Problem(){this.type=new Array("number","string","character"),this.num_operation=new Array("plus","minus","multi","divide"),this.numberfalse=new Array("string","character"),this.characterfalse=new Array("number","string"),this.stringfalse=new Array("character","number"),this.letters=new Array("a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"),this.current=null,this.next=null,this.isOdd=null,this.isEven=null,this.cans=null,this.nans=null,this.container=new Array}function true_false(){this.ctrl_container=$(".controlls"),this.disp_question=$("span.question"),this.disp_problem=$("span.problem"),this.disp_score=$(".score-value"),this.disp_time=$(".timer-rest"),this.disp_multiplier=$(".multiplier"),this.score=0,this.multiplier=1,this.consecutive=0,this.xconsecutive=0,this.wrong=0,this.probCounter=1,this.prob=new Array,this.sound=$(".sound-pop"),this.ready()}function menu(){this.start_menu=$(".start-menu"),this.disp_timer_intro=$(".intro-timer"),this.img_how=$(".img-how"),this.start_button=$(".start-button"),this.disp_finish=$(".finish-game"),this.ready()}timer.prototype={set_config:function(t){this.disp_timer=t.display,this.timerSet=t.timerSet,this.callback=t.callback,this.remap_display=t.remap_display,this.ready(),this.start()},ready:function(){console.log(this.ticktock),this.update_timer_display(this.timerSet)},start:function(){this.startTime=new Date,this.isRunning=!0,this.request_id=requestAnimationFrame(this.start_counter)},stop_counter:function(){return timer.ticktock.get(0).pause(),this.isRunning=!1,cancelAnimationFrame(timer.request_id),timer.request_id=null,this.callback()},get_elapsed_time:function(){return timer.isRunning?new Date-timer.startTime:void 0},update_timer_display:function(t){1==this.remap_display?(1==t.toString().length&&(t="0"+t.toString()),this.disp_timer.html("00:"+t)):this.disp_timer.html(t)},start_counter:function(){var t=1e3*timer.timerSet,i=timer.get_elapsed_time(),e=timer.timerSet-parseInt(i/t*timer.timerSet);1==timer.isRunning&&(timer.update_timer_display(e),10>e&&timer.ticktock.get(0).play(),i>t?(timer.isRunning=!1,timer.stop_counter()):timer.request_id=requestAnimationFrame(timer.start_counter))}};var timer=new timer({display:$(".intro-timer"),timerSet:0});Problem.prototype={regenerate:function(t){for(;t.length<10;){var i=this.getCombination();t.push(i)}},getCombination:function(){var t=this.getRandomInt(0,2),i=this.getRandomInt(0,3),e=this.type[i],s=null,r=!1,n=null;if(1==t)n=this.mytype(e),r=!0;else{var a=null;"number"==e?(a=this.numberfalse[t],n=this.mytype(a)):"string"==e?(a=this.stringfalse[t],n=this.mytype(a)):"character"==e&&(a=this.characterfalse[t],n=this.mytype(a))}return s="Is "+e,{q:s,d:n,a:r}},getRandomInt:function(t,i){return Math.floor(Math.random()*(i-t))+t},generateChar:function(){var t=this.getRandomInt(0,27),i=this.letters[t];return i},generateString:function(){for(var t=new Array;t.length<3;)t.push(this.generateChar());return t.join("")},mytype:function(t){var i=null;if("number"==t){var e=this.getRandomInt(0,99);i=e}else if("string"==t){var s=this.generateString();i=s}else if("character"==t){var r=this.generateChar();i=r}return i}};var Problem=new Problem;true_false.prototype={start:function(){timer.set_config({display:this.disp_time,timerSet:60,callback:this.finish,remap_display:!0})},ready:function(){var t=this;this.ctrl_container.on("click",".ctrl",function(i){i.preventDefault(),i.stopPropagation(),t.ctrl_triggered(i)}),$("body").on("keyup",function(i){var e=null;1==timer.isRunning&&(39==i.keyCode||37==i.keyCode)&&(39==i.keyCode?e="no":37==i.keyCode&&(e="yes"),t.process_event(e))}),Problem.regenerate(this.prob),this.display()},ctrl_triggered:function(t){if(1==timer.isRunning){var i=$(t.target),e="no";i.hasClass("yes")&&(e="yes"),this.process_event(e)}},process_event:function(t){"yes"==t?1==this.ans?this.correct_update():this.wrong_update():0==this.ans?this.correct_update():this.wrong_update(),this.consecutive>4&&(this.multiplier<=9&&(this.multiplier++,this.update_multiplier(!0)),this.reset_consecutive()),this.xconsecutive>3&&this.multiplier>1&&(this.multiplier--,this.update_multiplier(!1)),this.display(),this.prob.length<2&&Problem.regenerate(this.prob)},reset_consecutive:function(){this.xconsecutive=0,this.consecutive=0},reset_multiplier_disp:function(){var t=this.disp_multiplier.find("div.active").first();t.nextAll("div").removeClass("active")},reset_all:function(){this.reset_consecutive(),this.wrong=0,this.score=0,this.multiplier=1,this.probCounter=1,this.reset_multiplier_disp(),this.update_score(0)},correct_update:function(){this.sound.get(0).play(),this.update_score(2),this.consecutive++,this.xconsecutive=0},wrong_update:function(){this.consecutive=0,this.xconsecutive++,this.wrong++},display:function(){var t=this.prob.pop();this.probCounter++,this.disp_question.html(t.q),this.disp_problem.html(t.d),this.ans=t.a},update_score:function(t){this.score+=t,this.disp_score.html(this.score)},update_multiplier:function(t){var i=this.disp_multiplier.find("div.active");t?i.next("div").addClass("active"):i.last().removeClass("active")},finish:function(){timer.isRunning=!1;var t={score:true_false.score,mul:true_false.multiplier,wrong:true_false.wrong,prob:true_false.probCounter};menu.finish(t),window.setTimeout(function(){true_false.reset_all()},1e3),console.log("im called finish")}};var true_false=new true_false;menu.prototype={ready:function(){var t=this;this.start_button.on("click",function(){t.start()})},start:function(){var t=this;this.disp_finish.addClass("d0").removeClass("d2"),t.disp_timer_intro.css("z-index","1").fadeIn("fast"),timer.set_config({display:t.disp_timer_intro,timerSet:3,callback:t.stop})},stop:function(){menu.start_menu.addClass("anim_left"),window.setTimeout(function(){menu.start_menu.addClass("anim_original"),menu.start_menu.removeClass("anim_left"),menu.disp_timer_intro.get(0).removeAttribute("style"),true_false.start()},1500)},finish:function(t){var i=window;menu.start_menu.addClass("d2"),menu.game_complete(t),i.setTimeout(function(){menu.start_menu.addClass("anim_back"),i.setTimeout(function(){menu.start_menu.removeClass("anim_original anim_back d2")},1e3)},500)},game_complete:function(t){var i=t.prob-t.wrong+"/"+t.prob,e=t.score*t.mul,s=this.disp_finish;this.start_button.html("TRY AGAIN"),this.disp_timer_intro.removeClass("d2").addClass("d0"),this.img_how.removeClass("d0").addClass("d2"),s.removeClass("d0").addClass("d2"),s.find(".finish-score").find("p").last().html(e),s.find(".finish-acc").find("p").last().html(i)}};var menu=new menu;